<div class="content-wrapper">
  <!-- Content Header (Page header) -->
  <section class="content-header">
    <h1>
      <!-- Page Header 1111 -->
	   Lista Despachos Pedidos
      <small>Consulta de los despachos para su correspondiente registro y entrega</small>
    </h1>
    <ol class="breadcrumb">
      <li><i class="fa fa-dashboard"></i>Despachos</li>
      <li class="active">Lista de Despachos</li>
    </ol>
  </section>
  
    <div *ngIf="success" class="col-lg-12 alerts">
        <div id="custom-alerts" style="display:none;">
            <div class="alert alert-dismissable">
                <div class="custom-msg"></div>
            </div>
        </div>
        <div class="alert alert-success alert-dismissable">
            <button aria-hidden="true" data-dismiss="alert" class="close" type="button">X</button>
            <h4>	<i class="icon fa fa-check"></i> Éxito</h4> Despacho registrado con éxito 
		</div>
    </div>
	
	<div *ngIf="success_act" class="col-lg-12 alerts">
        <div id="custom-alerts" style="display:none;">
            <div class="alert alert-dismissable">
                <div class="custom-msg"></div>
            </div>
        </div>
        <div class="alert alert-success alert-dismissable">
            <button aria-hidden="true" data-dismiss="alert" class="close" type="button">X</button>
            <h4>	<i class="icon fa fa-check"></i> Éxito</h4> Despacho registrado con éxito 
		</div>
    </div>
	
	<div *ngIf="espera_correo_facturacion"  class="col-lg-12 alerts">
        <div id="custom-alerts" style="display:none;">
            <div class="callout callout-warning">
                <div class="custom-msg"></div>
            </div>
        </div>
        <div class="callout callout-warning warning-dismissable">
            <button aria-hidden="true" data-dismiss="callout" class="close" type="button">X</button>
            <h4><i class="icon fa fa-warning"></i> Enviándo correo por favor espere ..!!!</h4>Enviando correo al Departamento de Facturación...!!!
		</div>
    </div>
	
	<div *ngIf="espera_exitoso_facturacion"   class="col-lg-12 alerts">
        <div id="custom-alerts" style="display:none;">
            <div class="alert alert-dismissable">
                <div class="custom-msg"></div>
            </div>
        </div>
        <div class="alert alert-success alert-dismissable">
            <button aria-hidden="true" data-dismiss="alert" class="close" type="button">X</button>
            <h4>	<i class="icon fa fa-check"></i> Éxito</h4> Correo enviado con exito al Departamento de Facturación...!!!
		</div>
    </div>
	
	<div *ngIf="espera_correo_pedido"  class="col-lg-12 alerts">
	<!-- <div  class="col-lg-12 alerts"> -->
        <div id="custom-alerts" style="display:none;">
            <div class="callout callout-warning">
                <div class="custom-msg"></div>
            </div>
        </div>
        <div class="callout callout-warning warning-dismissable">
            <button aria-hidden="true" data-dismiss="callout" class="close" type="button">X</button>
            <h4><i class="icon fa fa-warning"></i> Enviándo correo por favor espere ..!!!</h4>Enviando correo al Cliente...!!!
		</div>
    </div>
	
	<div *ngIf="espera_exitoso_pedido"   class="col-lg-12 alerts">
	<!-- <div   class="col-lg-12 alerts"> -->
        <div id="custom-alerts" style="display:none;">
            <div class="alert alert-dismissable">
                <div class="custom-msg"></div>
            </div>
        </div>
        <div class="alert alert-success alert-dismissable">
            <button aria-hidden="true" data-dismiss="alert" class="close" type="button">X</button>
            <h4>	<i class="icon fa fa-check"></i> Éxito</h4> Correo enviado con exito al Cliente...!!!
		</div>
    </div>
	
	<!-- *ngIf="error_envio_correo"   -->
	<div  *ngIf="error_envio_correo"  class="col-lg-12 alerts">
        <div id="custom-alerts" style="display:none;">
            <div class="alert alert-dismissable">
                <div class="custom-msg"></div>
            </div>
        </div>
        <div class="alert callout callout-danger">
            <button aria-hidden="true" data-dismiss="alert" class="close" type="button">X</button>
            <h4>	<i class="icon fa fa-warning"></i> Envio fallido de correo</h4> {{descripcion_error}}
		</div>
    </div>
	

	
	<div *ngIf="espera_generar_pdf"  class="col-lg-12 alerts">
        <div id="custom-alerts" style="display:none;">
            <div class="callout callout-warning">
                <div class="custom-msg"></div>
            </div>
        </div>
        <div class="callout callout-warning warning-dismissable">
            <button aria-hidden="true" data-dismiss="callout" class="close" type="button">X</button>
            <h4><i class="icon fa fa-warning"></i> Generando PDF por favor espere ..!!!</h4>
		</div>
    </div>
	
	<!-- <div *ngIf="espera_exitoso_pedido"   class="col-lg-12 alerts"> -->
        <!-- <div id="custom-alerts" style="display:none;"> -->
            <!-- <div class="alert alert-dismissable"> -->
                <!-- <div class="custom-msg"></div> -->
            <!-- </div> -->
        <!-- </div> -->
        <!-- <div class="alert alert-success alert-dismissable"> -->
            <!-- <button aria-hidden="true" data-dismiss="alert" class="close" type="button">X</button> -->
            <!-- <h4>	<i class="icon fa fa-check"></i> Éxito</h4> Correo enviado con exito al Cliente...!!! -->
		<!-- </div> -->
    <!-- </div> -->

<section class="content">
    <div class="row">
	
	
	    <div class="col-xs-12">
            <div class="box box-primary">
				<div class="box-header">
					<label for="reference">SELECCIONE RANGO DE FECHA DE LOS DESPACHO ENTREGADO/POR ENTREGAR</label>
                </div>
				 <div class="box-header text-left">

				 
				  <div class="col-md-2">
								<label for="fecha_desde">Fecha desde: </label>
								<input [(ngModel)]="fecha_desde" type="date" name="fecha_desde" placeholder="dd-mm-yyyy" value="" min="1997-01-01" max="2030-12-31">
								
				 </div>

				 <div class="col-md-2">
								<label for="fecha_hasta">Fecha hasta: </label>
								<input [(ngModel)]="fecha_hasta" type="date" name="fecha_hasta" placeholder="dd-mm-yyyy" value="" min="1997-01-01" max="2030-12-31">
				 </div>
				 <div class="col-md-2">
					<div class="form-group">
						<label>Ruta:</label>
						<select  name="ruta" [(ngModel)]="ruta" class="form-control select2 tip" style="width:100%;">
<!-- 						<option [ngValue]="undefined" disabled  selected>Seleccione</option> -->
						<option *ngFor="let e of lista_rutas"  [value]="e.idruta">{{e.nombre_ruta}}</option>
						</select>
					
					</div>
				</div>
				<div class="col-md-2">
					<div class="form-group">
						<label>Status entrega:</label>
						<select  name="ruta" [(ngModel)]="status_entrega" class="form-control select2 tip" style="width:100%;">
<!-- 						<option [ngValue]="undefined" disabled  selected>Seleccione</option> -->
						<option *ngFor="let e of lista_status"  [value]="e.nombre_status">{{e.nombre_status}}</option>
						</select>
					
					</div>
				</div>
				
				<div class="col-md-2">
							<br>
							<input  type="submit" (click)="buscar_factura_fecha()"  name="Buscar" value="Buscar por fecha" class="btn btn-primary">
				</div>





				</div>
				
					
                <!-- </div> -->
				
                <div class="box-body">
				<div class="table-responsive">
				<!-- <table *ngIf="!loading" datatable class="row-border hover">  -->
					<div *ngIf="loading" class="col-md-12">
						  <div class="box box-primary">
							<div class="text-center box-header">
							  <h3 class="box-title ">Cargando. Generando tabla....!!!!</h3>
							</div>
							<div class="box-body">
							  <!-- The body of the box -->
							</div>
							<div class="overlay">
							  <i class="fa fa-refresh fa-spin"></i>
							</div>
							<!-- end loading -->
						  </div>
						  <!-- /.box -->
					</div>
				
				<table *ngIf="!loading" datatable [dtOptions]="dtOptions" class="table table-striped table-bordered table-condensed table-hover dataTable"> 
				<!-- <table *ngIf="!loading" datatable [dtOptions]="dtOptions" class="dataTable">  -->
						<thead>
						<tr>
						  <th>Fecha Entrega</th>
						  <th>NoPedido</th>
						  <th>IdDespacho</th>
<!-- 						  <th>TipoDoc</th> -->
<!-- 						  <th>Vendedor</th> -->
						  <th>Cliente</th>
						  <th>Dir Entrega</th>
						  
						  <th>Hora Entrega</th>
<!-- 						  <th>Email</th> -->
<!-- 						  <th>Total (USD)</th> -->
						  <th>Observación/Entrega</th>
						  <th>Ruta</th>
						  <th>Estado Envio</th>
						  <!-- <th>Fecha/hora entrega</th> -->
						  <!-- <th>Direcc entrega</th> -->
						  <!-- <th>Ruta asignada</th> -->
						  <th style="width:95px;" role="columnheader" rowspan="1" colspan="1" >Acciones</th>
						  
						</tr>
					  </thead>
					  
					<tbody *ngIf="(lista_pedidos?.length != 0) && (!loading) ">
					  <tr *ngFor="let el of lista_pedidos;">
						  <td>{{el.fecha_entrega}}</td>
						  <td>{{el.numtra}}</td>
						  <td>{{el.id_pedido_ruta}}</td>
<!-- 						  <td *ngIf="el.tiptra==1">
						  PEDIDO
						  </td>
						  <td *ngIf="el.tiptra==2">
						  PROFORMA
						  </td> -->
	<!-- 					  <td>{{el.nomusu}}</td> -->
						  <td>{{el.nomcli}}</td>
						  <td>{{el.direccion_entrega}}</td>
						  
						  <td>{{el.hora_entrega}}</td>
<!-- 						  <td>{{el.email}}</td> -->
<!-- 						  <td>{{el.totnet}}</td> -->
						  <td *ngIf="el.status_entrega == 'PLANIFICADO'" >{{el.observ}}</td>
						  <td *ngIf="el.status_entrega == 'NO DESPACHADO'" >{{el.observacion_entrega}}</td>
						  <td *ngIf="el.status_entrega == 'DESPACHADO'" >{{el.observacion_entrega}}</td>
						  <td *ngIf="el.status_entrega == 'ENTREGADO MENSAJERO'" >{{el.observacion_entrega}}</td>
						  <td>{{el.ruta}}</td>

						<td class="text-center" *ngIf="el.status_entrega == 'PLANIFICADO'">
							<span style="color:blue;font-weight:bold" >{{el.status_entrega}}</span>
						</td>
						
						<td class="text-center" *ngIf="el.status_entrega == 'NO DESPACHADO'">
						<span style="color:red;font-weight:bold" > {{el.status_entrega}}</span>
						</td>
						
						<td class="text-center" *ngIf="el.status_entrega == 'DESPACHADO'" >
							<span style="color:green;font-weight:bold" >{{el.status_entrega}}</span>
						</td>

						<td class="text-center" *ngIf="el.status_entrega == 'ENTREGADO MENSAJERO'" >
							<span style="color:rgb(79, 128, 0);font-weight:bold" >{{el.status_entrega}}</span>
						</td>

						  <td class="">
						    <div class="text-center">
                                <div class="btn-group">

									<!-- <a routerLink="/admin/ver_pedidos" [queryParams]="{usuario:usuario,empresa: empresa,pedido:el.numtra,sucursal:el.direccion_entrega}"  class="tip btn btn-primary btn-xs"><i class="fa fa-file-text-o" title="Ver pedido"></i></a>  -->
									
									<a *ngIf="el.status_entrega == 'PLANIFICADO' || el.status_entrega == 'ENTREGADO MENSAJERO' " routerLink="/admin/registro_despachos" [queryParams]="{usuario:usuario,empresa: empresa,pedido:el.numtra,tiptra:el.tiptra,id_pedido_ruta:el.id_pedido_ruta,status_entrega:el.status_entrega}" class="tip btn btn-warning btn-xs"><i class="fa fa-edit" title="registrar despacho"></i>Registrar Despacho</a> 
									<a *ngIf="el.status_entrega == 'DESPACHADO' || el.status_entrega == 'NO DESPACHADO'" routerLink="/admin/registro_despachos" [queryParams]="{usuario:usuario,empresa: empresa,pedido:el.numtra,tiptra:el.tiptra,id_pedido_ruta:el.id_pedido_ruta,status_entrega:el.status_entrega}" class="tip btn btn-danger btn-xs"><i class="fa fa-edit" title="ver despacho"></i>Ver Despacho</a> 
									<!-- <a href="http://amort.lavisita360.com/purchases/delete/6" onclick="return confirm('Usted va a eliminar la compra, por favor haga clic en Aceptar para eliminar.')" title="" class="tip btn btn-danger btn-xs" data-original-title="Eliminar Compra"><i class="fa fa-trash-o"></i></a> -->
									
									<a *ngIf="srv.getConfCorreoFact() != 'NO'" (click)="correo_facturacion(el.numtra,el.nomcli)" class="tip btn btn-danger btn-xs" ><i class="fa fa-envelope" title="Enviar correo facturar pedido" ></i></a>
									<!-- <a (click)="confirm_delete()"   class="tip btn btn-danger btn-xs" ><i class="fa fa-envelope" title="Enviar correo facturar pedido" ></i></a> -->
									
									<a *ngIf="srv.getConfCorreoPedCli() != 'NO'" (click)="correo_pedido(el.numtra,el.nomcli,el.email)"  class="tip btn btn-success btn-xs" ><i class="fa fa-envelope" title="Reenviar correo pedido" ></i></a>
<!-- 									<a  (click)="generar_pdf_ped(el.numtra,el.tiptra)"  class="tip btn btn-danger btn-xs" ><i class="fa fa-search" title="Ver/Imprimir" ></i></a> -->
								
								</div>
                            </div>
						  </td>
					  </tr>
					</tbody> 
				</table>
	
					</div>
				</div>
			</div>
        </div>
   </div>
</section>
  <!-- /.content -->
</div>
